<div class="auth-wrapper">
  <div class="auth-card">
    
    <header class="auth-header">
      <div class="logo-icon" style="font-size: 2.5rem; color: var(--accent); margin-bottom: 10px;">
        <i class="fas fa-unlock-alt"></i>
      </div>
      <h2>Recuperar Acceso</h2>
      
      <p *ngIf="step === 1">Ingresa tu correo para buscar tu cuenta.</p>
      <p *ngIf="step === 2" style="color: var(--accent); font-weight: 600;">
        ¡Código enviado! Revisa tu bandeja.
      </p>
    </header>

    <div *ngIf="errorMessage" class="alert error" style="background: #fee2e2; color: #dc2626; padding: 12px; border-radius: 8px; margin-bottom: 20px; font-size: 0.9rem; font-weight: 600; text-align: center;">
      <i class="fas fa-exclamation-circle"></i> {{ errorMessage }}
    </div>

    <form *ngIf="step === 1" [formGroup]="emailForm" (ngSubmit)="enviarCodigo()">
      
      <div class="form-group input-with-icon">
        <label for="email">Correo Electrónico</label>
        <i class="fas fa-envelope"></i>
        <input id="email" type="email" formControlName="email" placeholder="correo@ejemplo.com">
        
        <div *ngIf="emailForm.get('email')?.invalid && emailForm.get('email')?.touched" class="validation-error">
            Correo inválido.
        </div>
      </div>

      <button type="submit" [disabled]="emailForm.invalid || cargando" class="btn-primary">
        <span *ngIf="!cargando">ENVIAR CÓDIGO</span>
        <span *ngIf="cargando"><i class="fas fa-spinner fa-spin"></i> Enviando...</span>
      </button>

    </form>

    <form *ngIf="step === 2" [formGroup]="resetForm" (ngSubmit)="cambiarPassword()">
      
      <div style="background: #eff6ff; color: #1e40af; padding: 10px; border-radius: 8px; font-size: 0.8rem; margin-bottom: 15px; text-align: center;">
        <i class="fas fa-info-circle"></i> Tip: Usa el código <strong>1234</strong> para probar.
      </div>

      <div class="form-group input-with-icon">
        <label for="codigo">Código de Verificación</label>
        <i class="fas fa-hashtag"></i>
        <input id="codigo" type="text" formControlName="codigo" placeholder="Ej: 1234" maxlength="4" style="letter-spacing: 5px; text-align: center; font-weight: 800;">
      </div>

      <div class="form-group input-with-icon">
        <label for="newPass">Nueva Contraseña</label>
        <i class="fas fa-lock"></i>
        <input id="newPass" type="password" formControlName="password" placeholder="Mínimo 6 caracteres">
      </div>

      <div class="form-group input-with-icon">
        <label for="confirmPass">Confirmar Contraseña</label>
        <i class="fas fa-check-double"></i>
        <input id="confirmPass" type="password" formControlName="confirmPassword" placeholder="Repite la contraseña">
      </div>

      <button type="submit" [disabled]="resetForm.invalid || cargando" class="btn-primary">
        <span *ngIf="!cargando">ACTUALIZAR PASSWORD</span>
        <span *ngIf="cargando"><i class="fas fa-spinner fa-spin"></i> Procesando...</span>
      </button>

    </form>

    <div class="auth-footer">
      <a [routerLink]="['/auth/login']" style="display: flex; align-items: center; justify-content: center; gap: 5px;">
        <i class="fas fa-arrow-left"></i> Volver al Login
      </a>
    </div>

  </div>
</div>